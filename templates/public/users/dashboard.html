{% extends 'public/base.html' %}
{% load static %}
{% block content %}
  <div class="container-fluid">
    <div class="page-title mt-3">
      <div class="row">
        <div class="col-sm-6 col-12">
          <h2>Dashboard</h2>
        </div>
        <div class="col-sm-6 col-12">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'home' %}"><i class="iconly-Home icli svg-color"></i></a></li>
            <li class="breadcrumb-item">Profile</li>
            <li class="breadcrumb-item active">Dashboard</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <!-- Container-fluid starts-->
  <div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        {% include 'public/users/partials/_sidebar.html' %}

        <!-- Main Content -->
        <div class="col-xl-9 col-md-8 box-col-8">
            <div class="file-content">
                <!-- Overview Tab -->
                <div class="tab-content active" id="overview-content">
                    <div class="card">
                        <div class="card-header">
                            <h5>Overview</h5>
                        </div>
                        <div class="card-body">
                            <!-- Stats Cards -->
                            <div class="row mb-4">
                                <div class="col-lg-3 col-md-6 col-sm-6">
                                    <div class="stats-card">
                                        <div class="stats-icon bg-primary">
                                            <i data-feather="user"></i>
                                        </div>
                                        <div class="ribbon-wrapper border border-1">
                                            <div class="ribbon ribbon-primary ribbon-clip">Profile</div>
                                            {{ user.profile.completion_percentage|default:"0" }}% Complete
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-6">
                                    <div class="stats-card">
                                        <div class="stats-icon bg-primary">
                                            <i data-feather="user"></i>
                                        </div>
                                        <div class="ribbon-wrapper border border-1">
                                            <div class="ribbon ribbon-primary ribbon-clip">Membership</div>
                                            {% if user.membership %}
                                                {{ user.membership.status }}
                                            {% else %}
                                            <a href="/memberships/registration/" class="btn btn-outline-primary-2x">
                                                <i data-feather="plus-circle" class="me-1"></i>Apply Membership
                                            </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-6">
                                    <div class="stats-card">
                                        <div class="stats-icon bg-primary">
                                            <i data-feather="user"></i>
                                        </div>
                                        <div class="ribbon-wrapper border border-1">
                                            <div class="ribbon ribbon-primary ribbon-clip">Donations</div>
                                            <div class="d-flex justify-content-between">
                                                <div class="col-6">
                                                    5 times
                                                </div>
                                                <div class="col-6">
                                                    $<i class="f-w-500">1500</i> Total
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-6">
                                    <div class="stats-card">
                                        <div class="stats-icon bg-primary">
                                            <i data-feather="user"></i>
                                        </div>
                                        <div class="ribbon-wrapper border border-1">
                                            <div class="ribbon ribbon-warning ribbon-clip">Events</div>
                                            Upcoming - 3
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-3 col-md-6 col-sm-6">
                                    <div class="stats-card">
                                        <div class="stats-icon bg-info">
                                            <i data-feather="calendar"></i>
                                        </div>
                                        <div class="stats-content">
                                            <h4>Events</h4>
                                            <p>2 Upcoming</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Activity -->
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="activity-section">
                                        <h6>Recent Activity</h6>
                                        <div class="activity-list">
                                            <div class="activity-item">
                                                <div class="activity-icon bg-primary">
                                                    <i data-feather="user"></i>
                                                </div>
                                                <div class="activity-content">
                                                    <h6>Profile Updated</h6>
                                                    <p class="text-muted">You updated your profile information</p>
                                                    <small class="text-muted">2 hours ago</small>
                                                </div>
                                            </div>
                                            <div class="activity-item">
                                                <div class="activity-icon bg-success">
                                                    <i data-feather="check-circle"></i>
                                                </div>
                                                <div class="activity-content">
                                                    <h6>Account Verified</h6>
                                                    <p class="text-muted">Your email has been verified</p>
                                                    <small class="text-muted">1 day ago</small>
                                                </div>
                                            </div>
                                            <div class="activity-item">
                                                <div class="activity-icon bg-info">
                                                    <i data-feather="log-in"></i>
                                                </div>
                                                <div class="activity-content">
                                                    <h6>Account Created</h6>
                                                    <p class="text-muted">Welcome to BMR community</p>
                                                    <small class="text-muted">3 days ago</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="notifications-section">
                                        <h6>Notifications</h6>
                                        <div class="notification-list">
                                            <div class="notification-item">
                                                <div class="notification-icon">
                                                    <i data-feather="bell" class="text-warning"></i>
                                                </div>
                                                <div class="notification-content">
                                                    <p>Complete your membership application</p>
                                                    <small class="text-muted">New</small>
                                                </div>
                                            </div>
                                            <div class="notification-item">
                                                <div class="notification-icon">
                                                    <i data-feather="calendar" class="text-info"></i>
                                                </div>
                                                <div class="notification-content">
                                                    <p>Upcoming meditation retreat</p>
                                                    <small class="text-muted">Tomorrow</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Tab -->
                <div class="tab-content" id="profile-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5>Profile Information</h5>
                                <a href="" class="btn btn-primary btn-sm">
                                    <i data-feather="edit-2" class="me-1"></i>Edit Profile
                                </a>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 text-center">
                                    {% if user.profile.avatar %}
                                        <img src="{{ user.profile.avatar.url }}" alt="Profile" class="profile-image mb-3">
                                    {% else %}
                                        <img src="{% static 'assets/images/profile.png' %}" alt="Profile" class="profile-image mb-3">
                                    {% endif %}
                                </div>
                                <div class="col-md-8">
                                    <div class="profile-details">
                                        <div class="detail-item">
                                            <label>Full Name</label>
                                            <p>{{ user.profile.first_name|default:"Not provided" }}</p>
                                        </div>
                                        <div class="detail-item">
                                            <label>Email</label>
                                            <p>{{ user.email }}</p>
                                        </div>
                                        <div class="detail-item">
                                            <label>Primary Mobile</label>
                                            <p>{{ user.profile.decrypted_mobile|default:"Not provided" }}</p>
                                        </div>
                                        <div class="detail-item">
                                            <label>Secondary Mobile</label>
                                            <p>{{ user.profile.decrypted_mobile_secondary|default:"Not provided" }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Membership Tab -->
                <div class="tab-content" id="membership-content">
                    <div class="card">
                        <div class="card-header">
                            <h5>Membership Details</h5>
                        </div>
                        <div class="card-body">
                            {% if user.membership %}
                                <div class="membership-status">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="membership-info">
                                                <h6>Current Membership</h6>
                                                <div class="membership-card">
                                                    <h4>{{ user.membership.type.name }}</h4>
                                                    <p class="text-muted">Status: <span class="badge bg-{{ user.membership.status|lower }}">{{ user.membership.status }}</span></p>
                                                    <p class="text-muted">Applied: {{ user.membership.created_at|date:"M d, Y" }}</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="membership-progress">
                                                <h6>Application Progress</h6>
                                                <div class="progress-steps">
                                                    <div class="step completed">
                                                        <i data-feather="check"></i>
                                                        <span>Application Submitted</span>
                                                    </div>
                                                    <div class="step {% if user.membership.document_status == 'VERIFIED' %}completed{% endif %}">
                                                        <i data-feather="file-text"></i>
                                                        <span>Document Verification</span>
                                                    </div>
                                                    <div class="step {% if user.membership.payment_status == 'COMPLETED' %}completed{% endif %}">
                                                        <i data-feather="credit-card"></i>
                                                        <span>Payment</span>
                                                    </div>
                                                    <div class="step {% if user.membership.status == 'APPROVED' %}completed{% endif %}">
                                                        <i data-feather="award"></i>
                                                        <span>Approval</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% else %}
                                <div class="no-membership">
                                    <div class="text-center py-5">
                                        <i data-feather="credit-card" class="mb-3" style="width: 64px; height: 64px; color: #6c757d;"></i>
                                        <h4 class="text-muted">No Active Membership</h4>
                                        <p class="text-muted mb-4">Join our community by applying for membership</p>
                                        <a href="{% url 'member_reg_step_1' %}" class="btn btn-primary">
                                            <i data-feather="plus-circle" class="me-1"></i>Apply for Membership
                                        </a>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Donations Tab -->
                <div class="tab-content" id="donations-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5>Donation History</h5>
                                <a href="#" class="btn btn-primary btn-sm">
                                    <i data-feather="heart" class="me-1"></i>Make Donation
                                </a>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="no-donations">
                                <div class="text-center py-5">
                                    <i data-feather="heart" class="mb-3" style="width: 64px; height: 64px; color: #6c757d;"></i>
                                    <h4 class="text-muted">No Donations Yet</h4>
                                    <p class="text-muted mb-4">Support our community with your generous donations</p>
                                    <a href="#" class="btn btn-primary">
                                        <i data-feather="heart" class="me-1"></i>Make Your First Donation
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>
{% endblock %}