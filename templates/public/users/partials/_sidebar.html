{% load static %}
<div class="col-xl-3 col-md-4 box-col-4">
    <div class="file-sidebar">
        <div class="card border-primary">
            <div class="card-body">
                <!-- User Profile Section -->
                <div id="sidebar-profile-card"
                     class="user-profile-section text-center"
                     data-fallback-avatar="{% if user.profile.avatar %}{{ user.profile.avatar.url }}{% else %}{% static 'assets/images/avtar/4.jpg' %}{% endif %}"
                     data-fallback-name="{{ user.profile.first_name|default:user.username }}"
                     data-fallback-username="{{ user.username }}"
                     data-fallback-email="{{ user.email }}"
                     data-fallback-membership="{% if user.membership %}{{ user.membership.type.name|default:'None' }}{% endif %}"
                     data-reference="{{ user.membership.reference_no|default_if_none:'' }}">
                    <div class="user-avatar mb-3">
                        <img data-sidebar-avatar src="{% static 'assets/images/avtar/4.jpg' %}" alt="Profile" class="img-90 rounded-circle border border-2 border-primary-subtle">
                    </div>
                    <div class="user-info">
                        <h6 class="mb-1" data-sidebar-name>Loading...</h6>
                        <p class="text-muted small mb-1" data-sidebar-email></p>
                        <div class="text-muted small" data-sidebar-username></div>
                        <span class="badge rounded-pill bg-secondary mt-2" data-sidebar-membership>Membership</span>
                        <div class="small text-muted mt-1">Ref: <span data-sidebar-ref>{{ user.membership.reference_no|default_if_none:"-" }}</span></div>
                    </div>
                </div>

                <hr>

                <!-- Navigation Menu -->
                <div class="">
                    <div class="list-group" id="list-tab" role="tablist">
                        <a class="list-group-item list-group-item-action bg-primary" id="list-home-list" aria-controls="list-home" aria-selected="false" tabindex="-1"><span class="fa fa-solid fa-bars"></span></a>
                        <a class="list-group-item list-group-item-action  list-hover-primary {% if 'memberships/my-dashboard/' in request.path or '/my-dashboard/' in request.path or request.path == '/profile' %}active{% endif %}" id="list-home-profile" href="{% url 'my_dashboard' %}"
                            aria-controls="list-home" aria-selected="{% if 'memberships/profile/' in request.path or '/profile/' in request.path or request.path == '/profile' %}true{% else %}false{% endif %}" tabindex="-1">Dashboard
                        </a>
                        {% if user.membership and user.membership.membership_number %}
                            <a class="list-group-item list-group-item-action list-hover-primary {% if 'memberships/registration/' in request.path or 'memberships/details' in request.path %}active{% endif %}" id="list-profile-list" href="" aria-controls="list-profile" aria-selected="false" tabindex="-1">Membership</a>
                        {% else %}
                            <a class="list-group-item list-group-item-action list-hover-primary {% if 'memberships/registration/' in request.path or 'memberships/details' in request.path %}active{% endif %}" id="list-profile-list" href="" aria-controls="list-profile" aria-selected="false" tabindex="-1">Membership</a>
                        {% endif %}
                        <a class="list-group-item list-group-item-action list-hover-primary {% if 'memberships/event/' in request.path %}active{% endif %}" id="list-settings-list" href="{% url 'member_event' %}" aria-controls="list-settings" aria-selected="true">Events & Donations
                        </a>
                    </div>
                </div>

                <hr>

                <!-- Quick Actions -->
                <div class="quick-actions text-center">
                    <h6 class="section-title mb-2 text-primary">Quick Actions</h6>
                    <div class="action-buttons">
                        {% if not user.membership %}
                        <a href="{% url 'member_reg_step_1' %}" class="btn btn-primary btn-sm w-100 mb-2 text-end">
                            <i data-feather="plus-circle" class="me-1"></i>Apply Membership
                        </a>
                        {% endif %}
                        <a href="{% url 'certificate_info' %}" class="btn btn-outline-primary btn-sm w-100 mb-2">
                            <i data-feather="download" class="me-1"></i>Certificate Gallery
                        </a>
                        <a href="#" class="btn btn-outline-secondary btn-sm w-100">
                            <i data-feather="help-circle" class="me-1"></i>Get Support
                        </a>
                    </div>
                </div>

                <hr>

                <!-- Logout -->
                <div class="logout-section">
                    <a href="{% url 'logout' %}" class="logout-link">
                        <i data-feather="log-out" class="me-2"></i>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="module" src="{% static 'js/users/sidebarProfile.js' %}"></script>
